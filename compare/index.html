<!DOCTYPE html>
<html>
<head>
  <title>BackstopJS Report</title>

  <link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="css/styles.css">

  <script type="text/javascript" src="bower_components/angular/angular.min.js"></script>
  <script type="text/javascript" src="bower_components/angular-route/angular-route.min.js"></script>
  <script type="text/javascript" src="bower_components/resemblejs/resemble.js"></script>
  <script type="text/javascript" src="bower_components/async/lib/async.js"></script>
  <script type="text/javascript" src="bower_components/completely/completely.js"></script>
  <script type="text/javascript" src="js/compare.js"></script>
</head>

<body ng-app="compareApp">

  <a class="anchor" id="root"></a>
  <div ng-controller="MainCtrl">
    <div class="summaryBlock">
      <div class='filterGroup form-group'>
        <div class="row">
          <div class="col-md-1">
            <label for="statusFilter" class="control-label">status</label>
            <select id="statusFilter" class="form-control" ng-model="statusFilter" ng-options="status for status in detailFilterOptions"></select>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="directoryFilter">filter</label>
              <div completely id="directoryFilter" suggestions="directories"></div>  
            </div>
          </div>
          <div class="col-md-2">
            <div class="filter-length"><span>showing</span> <strong>{{filtered.length}}</strong> <span>of</span> <strong>{{testPairs.length}}</strong></div>
          </div>
          <div class="col-md-4">
              
              <div class="stat-main-container">
                <div><label>totals</label></div>
                <div class="stat-main passed">
                  <div class="count">{{passedCount}}</div>
                  <div class="stat-label">passed</div>
                </div>
                
                <div class="stat-main failed">
                  <div class="count">{{testPairsCompleted-passedCount}}</div>
                  <div class="stat-label">failed</div>
                </div>
              </div>
              
              <!-- TODO: Enable clientside test mode -->
              <div class="stat" ng-if=displayMode>{{testPairsCompleted}} of {{testPairs.length}}</div>
              <div class="stat" ng-if=displayMode>{{testDuration/1000 | number : 2}}s</div>
              <div class="progressBarBlock" ng-if="testIsRunning">
                <div class="progress">
                  <div class="progress-bar progress-bar-striped active"  role="progressbar" aria-valuenow="{{testPairsCompleted}}" aria-valuemin="0" aria-valuemax="{{testPairs.length}}" style="width: {{testPairsCompleted/testPairs.length*100| number : 0}}%">
                    <span class="sr-only">{{testPairsCompleted}} of {{testPairs.length}}</span>
                  </div>
                </div>
              </div>
            
          </div>
          <div class="col-md-2 text-right logo-container">
            <div class="">
              <h2>CSS <br>Regression</h2>
            </div>
          </div>
        </div>
        <div class="row" ng-show="selection.length">
          <div class="col-md-12 command-container">
            <div class="text-right">              
              <!--<button class="btn btn-lg btn-primary" ng-click="createBaseline()">create baselines</button>-->
              <div><code>{{ gulpCommand }}</code></div>
            </div>
          </div>
        </div>
      </div>

      
      <div class="summary-list-container">
        <table class="summaryList">
        <thead>
          <tr>
            <th class="statusInds"><h3>Summary</h3></th>
            <th></th>
            <th class="baseline">
              <div class="baseline-header pull-right">
                <span>select to create new baseline</span> <i class="fa fa-long-arrow-down"></i>
              </div>
              
              <div class="test-all-checkbox pull-right">
                <label for="toggleAll">select all viewable</label>
                <input type="checkbox"
                  id="toggleAll" 
                  ng-model="allToggled"
                  ng-checked="filtered.length/3 == selection.length" 
                  ng-click="toggleAllViewable(filtered, allToggled)" />
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="thisTestPair in testPairs | filter : displayOnStatusFilter | filter : directoryFilter as filtered">
            <td class="statusInds">
              <div class="scanning" ng-if="thisTestPair.processing"><span class="dot yellow flash"></span>scanning</div>
              <div class="failed" ng-if="thisTestPair.testStatus=='fail'&&!thisTestPair.processing"><div class="stat-label">failed</div></div>
              <div class="passed" ng-if="thisTestPair.testStatus=='pass'"><div class="stat-label">passed</div></div>
              <div class="blessed" ng-if="thisTestPair.testStatus=='blessed'"><div class="stat-label">blessed</div></div>
            </td>
            <td class="test-summary">
              <test-result-summary></test-result-summary>
            </td>
            <td class="baseline">
              <baseline-checkbox></baseline-checkbox>
            </td>
          </tr>
        </tbody>
        </table>
      </div>
    </div> <!-- end summaryBlock -->

    <div class="detailReport">
    <h3>Details</h3>
    <div class="detail-container">
      <div class="detail" ng-repeat="thisTestPair in testPairs | filter : displayOnStatusFilter | filter : directoryFilter ">
      <a class="anchor" id="{{ thisTestPair.meta.fileName | anchor }}"></a>
      <table class="detail-topper">
        <thead>
          <tr>
            <th class="statusInds">
              <div class="failed" ng-if="thisTestPair.testStatus=='fail'&&!thisTestPair.processing"><div class="stat-label">failed</div></div>
              <div class="passed" ng-if="thisTestPair.testStatus=='pass'"><div class="stat-label">passed</div></div>
              <div class="blessed" ng-if="thisTestPair.testStatus=='blessed'"><div class="stat-label">blessed</div></div>
            </th>
            <th class="selector">
              <test-result-summary></test-result-summary>              
              {{msg}}
            </th>
            <th class="baseline">
              <baseline-checkbox></baseline-checkbox>
            </th>
          </tr>
        </thead>
      </table>
      <table class="detail-images">
          <tr>
            <th class="reference"><span class="detail-images-label">Baseline Reference</span></th>
            <th>
              <span class="detail-images-label">Test</span> 
              <button class="btn btn-primary btn-xs" ng-click="bless(thisTestPair.b.src, $index)"><i class="fa fa-thumbs-up"></i> Bless</button>
              <small class="bless-help"><em>(make this test image the new baseline reference)</em></small>
            </th>
            <th><span class="detail-images-label">Diff</span></th>
          </tr>
        </thead>
        <tr>
          <td class="reference">
            <img ng-src="{{ thisTestPair.a.src }}">
          </td>
          <td>
            <img ng-src="{{ thisTestPair.b.src }}">
          </td>
          <td>
            <img ng-src="{{ thisTestPair.c.src }}" image-name="c">
          </td>
        </tr>
      </table>
      </div>
    </div>

    </div> <!-- end detailReport -->


  <footer></footer>

  </div> <!-- end #root -->

</body>
</html>
